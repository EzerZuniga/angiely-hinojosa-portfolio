---
const navItems = [
  { name: "Inicio", href: "/" },
  { name: "Sobre mí", href: "/about" },
  { name: "Experiencia", href: "/experience" },
  { name: "Habilidades", href: "/skills" },
  { name: "Contacto", href: "/contact" },
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 w-full bg-white shadow-sm">
  <nav class="container flex flex-wrap items-center justify-between gap-6 py-4">
    <a href="/" class="flex items-center gap-3 text-left">
      <img
        src="/images/logo1.png"
        alt="Angiely Hinojosa"
        width="200"
        height="60"
        class="h-14 w-auto object-contain"
        loading="eager"
        decoding="async"
      />
    </a>

    <button
      class="flex h-11 w-11 items-center justify-center rounded-full border border-slate-200 text-slate-600 shadow-sm transition-colors hover:border-primary-200 hover:text-primary-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500 md:hidden"
      type="button"
      aria-expanded="false"
      aria-controls="mobile-menu"
      data-mobile-menu-button
    >
      <svg
        class="h-5 w-5"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
      <span class="sr-only">Abrir navegación</span>
    </button>

    <div class="hidden flex-1 items-center justify-end gap-10 md:flex">
      <ul class="flex items-center gap-8 text-sm font-semibold text-slate-600">
        {
          navItems.map((item) => (
            <li>
              <a
                href={item.href}
                class={`relative inline-flex items-center gap-2 transition-colors duration-150 hover:text-primary-600 ${
                  currentPath === item.href
                    ? "text-primary-600 after:absolute after:-bottom-2 after:left-0 after:h-[2px] after:w-full after:rounded-full after:bg-primary-500"
                    : ""
                }`}
              >
                {item.name}
              </a>
            </li>
          ))
        }
      </ul>
      <a
        href="/login"
        aria-label="Iniciar sesión"
        class="hidden items-center justify-center rounded-full bg-slate-100 p-2.5 text-slate-600 transition hover:bg-primary-50 hover:text-primary-600 lg:inline-flex"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          class="h-5 w-5"
        >
          <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
      </a>
    </div>

    <div
      id="mobile-menu"
      data-mobile-menu
      class="fixed inset-0 z-40 flex-col bg-white px-6 py-6 md:hidden"
      hidden
    >
      <div class="flex items-center justify-between">
        <img
          src="/images/logo1.png"
          alt="Angiely Hinojosa"
          width="200"
          height="60"
          class="h-14 w-auto object-contain"
          loading="lazy"
          decoding="async"
        />
        <button
          type="button"
          aria-label="Cerrar menú"
          class="flex h-11 w-11 items-center justify-center rounded-full bg-slate-100 text-slate-600 ring-1 ring-slate-200 transition hover:bg-slate-200 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500"
          data-mobile-menu-close
        >
          <svg
            class="h-5 w-5"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <nav
        class="mt-6 flex flex-1 flex-col justify-between overflow-y-auto text-slate-600"
      >
        <ul class="space-y-3 text-lg font-semibold">
          {
            navItems.map((item) => (
              <li>
                <a
                  href={item.href}
                  class={`flex items-center justify-between rounded-xl px-3 py-2 transition duration-150 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500 ${
                    currentPath === item.href
                      ? "bg-slate-100 text-primary-600 ring-1 ring-slate-200"
                      : "hover:bg-slate-50 hover:text-primary-600"
                  }`}
                >
                  <span>{item.name}</span>
                  <svg
                    class="h-4 w-4"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M9 5l7 7-7 7"
                    />
                  </svg>
                </a>
              </li>
            ))
          }
        </ul>

        <a
          href="/login"
          class="mt-6 flex items-center justify-center gap-2 rounded-full bg-slate-100 px-5 py-3 text-sm font-semibold text-slate-700 shadow-sm ring-1 ring-slate-200 transition hover:bg-slate-200 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="h-5 w-5"
          >
            <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          Iniciar sesión
        </a>
      </nav>
    </div>
  </nav>
</header>

<script is:inline>
  const menu = document.querySelector("[data-mobile-menu]");
  const openButton = document.querySelector("[data-mobile-menu-button]");
  const closeButton = document.querySelector("[data-mobile-menu-close]");

  const toggleMenu = (open) => {
    if (!menu || !openButton) return;
    const isOpen = open ?? menu.hasAttribute("hidden");
    menu.toggleAttribute("hidden", !isOpen);
    openButton.setAttribute("aria-expanded", String(isOpen));
  };

  openButton?.addEventListener("click", () => toggleMenu());
  closeButton?.addEventListener("click", () => toggleMenu(false));

  menu?.querySelectorAll("a").forEach((link) => {
    link.addEventListener("click", () => toggleMenu(false));
  });

  document.addEventListener("click", (event) => {
    if (!menu || menu.hasAttribute("hidden")) return;
    const target = event.target;
    if (
      target instanceof Element &&
      !menu.contains(target) &&
      !openButton?.contains(target)
    ) {
      toggleMenu(false);
    }
  });
</script>
